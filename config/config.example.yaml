# Keiba Data Analytics — 設定ファイルテンプレート
# config.yaml にコピーして、実際の値を設定してください。
# config.yaml は .gitignore に含まれています。

# データベース設定
database:
  # JVLinkToSQLiteが生成するSQLite DBのパス
  jvlink_db_path: "../mykeibadb_v3.61/mykeiba.db"
  # 拡張テーブル用DB（同一DBまたは別DB）
  extension_db_path: "./data/extension.db"
  # WALモード有効化
  wal_mode: true

# LLM Gateway設定
llm_gateway:
  # デフォルトプロバイダー: azure / vertex
  default_provider: "azure"

  # Azure AI Foundry
  azure:
    endpoint: "https://your-resource.openai.azure.com/"
    api_version: "2024-12-01-preview"
    # API keyは環境変数 AZURE_OPENAI_API_KEY で設定
    models:
      gpt4o: "gpt-4o"
      gpt4o_mini: "gpt-4o-mini"

  # GCP Vertex AI
  vertex:
    project_id: "your-gcp-project-id"
    location: "us-central1"
    # 認証はサービスアカウントキーまたはADCを使用
    models:
      gemini_pro: "gemini-2.0-pro-exp"
      gemini_flash: "gemini-2.0-flash"

  # 用途別モデル割り当て（Azure AI Foundry優先）
  # gpt-4o: 高性能、gpt-4o-mini: 低コスト・低遅延
  model_routing:
    deep_research:
      primary: "azure/gpt4o"
      fallback: "azure/gpt4o_mini"
    factor_generation:
      primary: "azure/gpt4o"
      fallback: "azure/gpt4o_mini"
    weekly_report:
      primary: "azure/gpt4o"
      fallback: "azure/gpt4o_mini"
    nl_query:
      primary: "azure/gpt4o_mini"
      fallback: "azure/gpt4o_mini"
    alert_interpretation:
      primary: "azure/gpt4o_mini"
      fallback: "azure/gpt4o_mini"
    race_analysis:
      primary: "azure/gpt4o"
      fallback: "azure/gpt4o_mini"
    report_generation:
      primary: "azure/gpt4o"
      fallback: "azure/gpt4o_mini"

# スコアリングエンジン
scoring:
  base_score: 100
  ev_threshold: 1.05
  min_odds: 1.5
  max_odds: 100.0
  calibration_method: "platt"  # platt / isotonic

# 資金管理
bankroll:
  initial_balance: 1000000
  betting_method: "quarter_kelly"  # equal / ev_proportional / quarter_kelly
  max_daily_rate: 0.20
  max_per_race_rate: 0.05
  drawdown_cutoff: 0.30
  recovery_step: 0.10

# 自動投票
betting:
  method: "dryrun"  # dryrun / ipatgo / selenium
  approval_required: true
  csv_output_dir: "./data/ipatgo"  # ipatgo方式のCSV出力先
  max_consecutive_losses: 20
  odds_deviation_threshold: 0.30
  initial_mode_duration_days: 30
  initial_mode_scale: 0.10

# JVLinkToSQLite同期
jvlink:
  exe_path: "./JVLinkToSQLiteArtifact_0.1.2.0.exe"
  retry_count: 3
  sync_timeout_sec: 600

# 通知設定
notification:
  # 通知レベル閾値: DEBUG / INFO / WARNING / ERROR
  min_level: "INFO"

  # Slack Webhook（空の場合は無効）
  slack_webhook_url: ""
  slack_channel: ""  # 空の場合はWebhookのデフォルトチャネル

  # Email (SMTP)（smtp_hostが空の場合は無効）
  smtp_host: ""
  smtp_port: 587
  smtp_user: ""
  smtp_password: ""  # 環境変数 SMTP_PASSWORD で設定推奨
  email_from: ""
  email_to: []  # 送信先リスト（例: ["user@example.com"]）

# 自動化パイプライン
automation:
  enabled: false                    # true にすると自動投票が有効化（要注意）
  race_days: [5, 6]                 # 曜日フィルタ（0=月〜6=日）、空リストで毎日
  max_races_per_day: 36             # 1日あたり最大処理レース数
  auto_reconcile: true              # パイプライン実行時に結果照合も自動実行

# ダッシュボード
dashboard:
  theme: "dark"
  port: 8501
  page_title: "Keiba Data Analytics"

# ログ
logging:
  level: "INFO"
  log_dir: "./logs"
  rotation: "10 MB"
  retention: "30 days"
